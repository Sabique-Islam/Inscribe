<!DOCTYPE html>
<html>
	{{ partial "header.html" . }}
	<body>
		<script type="application/ld+json">
		{
		  "@context": "https://schema.org",
		  "@type": "WebSite",
		  "name": "{{ .Site.Title }}",
		  "url": "{{ .Site.BaseURL }}",
		  "description": "{{ .Site.Params.description }}",
		  "author": {
		    "@type": "Person",
		    "name": "{{ .Site.Params.author }}"
		  }
		}
		</script>
		<div class="content">
			{{ partial "head.html" . }}
			
			<main class="list">
				<div class="site-description">
					{{- if .Content -}}
					<div class="home-content">
						{{ .Content }}
					</div>
					{{- else if isset .Site.Params "subtitle" -}}
					<p>{{ .Site.Params.Subtitle | .Page.RenderString }}</p>
					{{- end -}}
				</div>
				
				<!-- Spotify Now Playing Widget -->
				<div id="spotify-widget" class="spotify-widget">
					<div class="spotify-widget__header">
						<div id="status-text" class="spotify-widget__status">Listening to Spotify</div>
						<a id="spotify-logo" href="#" target="_blank" class="spotify-widget__logo" style="display: none;">
							<i class="si si-spotify"></i>
						</a>
					</div>
					<div id="spotify-content" class="spotify-widget__content">Loading Spotify track...</div>
				</div>
				{{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
				{{ $paginator := .Paginate (where $pages "Params.hidden" "ne" true) }}
				{{ range $paginator.Pages }}
				<section class="list-item">
					<h1 class="title"><a href="{{ .RelPermalink }}">{{.Title}}</a></h1>
					{{ if .Params.cover }}
					<div class="post-card">
						<div class="post-cover">
							<img src="{{ .Params.cover }}" alt="{{ .Title }}" loading="lazy">
						</div>
						<div class="post-content">
							<time>{{ dateFormat ":date_medium" .Date }} • {{ .ReadingTime }} min read{{ if .Draft }} <span class="draft-label">DRAFT</span> {{ end }}</time>
							{{ template "partials/pagedescription.html" . }}
							<a class="readmore" href="{{ .RelPermalink }}">Read more ⟶</a>
						</div>
					</div>
					{{ else }}
					<div class="post-card-no-cover">
						<time>{{ dateFormat ":date_medium" .Date }} • {{ .ReadingTime }} min read{{ if .Draft }} <span class="draft-label">DRAFT</span> {{ end }}</time>
						{{ template "partials/pagedescription.html" . }}
						<a class="readmore" href="{{ .RelPermalink }}">Read more ⟶</a>
					</div>
					{{ end }}
				</section>
				{{ end }}
				{{ template "partials/paginator.html" . }}
			</main>
			{{ partial "footer.html" . }}
		</div>
		
		<!-- <div id="comet-container"></div>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
		{{ $comet := resources.Get "js/comet.js" | minify | fingerprint }}
		<script src="{{ $comet.RelPermalink }}" defer></script> -->
	</body>
</html>
